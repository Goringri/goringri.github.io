<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ê¸‰ ìë¦¬ ë°°ì¹˜ í”„ë¡œê·¸ë¨</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --bg-color: #f0f4f8;
            --desk-color: #e6b800; /* ì±…ìƒ ìƒ‰ìƒ (ë‚˜ë¬´ìƒ‰ ëŠë‚Œ) */
            --desk-border: #b38f00;
            --text-color: #333;
        }

        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* ê³µí†µ ë ˆì´ì•„ì›ƒ */
        .container {
            width: 90%;
            max-width: 1200px;
            margin-top: 20px;
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        h1 { margin-bottom: 20px; color: var(--primary-color); }
        
        .screen { display: none; } /* í™”ë©´ ì „í™˜ìš© */
        .screen.active { display: block; }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: var(--primary-color);
            color: white;
            transition: background 0.3s;
            margin: 5px;
        }
        button:hover { background-color: #357abd; }
        button.secondary { background-color: #999; }
        button.danger { background-color: #e74c3c; }

        /* STEP 1: í•™ìƒ ìˆ˜ ì…ë ¥ */
        .input-group { margin: 20px 0; }
        input[type="number"] {
            padding: 10px;
            font-size: 16px;
            width: 100px;
            text-align: center;
        }

        /* STEP 2: ì´ë¦„ ì…ë ¥ */
        .name-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
            max-height: 50vh;
            overflow-y: auto;
        }
        .name-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        /* STEP 3: êµì‹¤ ë°°ì¹˜ (ë“œë˜ê·¸ ì˜ì—­) */
        #classroom-area {
            position: relative;
            width: 100%;
            height: 600px;
            background-color: #eef;
            border: 2px dashed #ccc;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden; /* ì˜ì—­ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ” ê²ƒ ë°©ì§€ */
        }

        .desk {
            position: absolute;
            width: 80px;
            height: 60px;
            background-color: var(--desk-color);
            border: 2px solid var(--desk-border);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: grab;
            user-select: none;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.1s;
            z-index: 10;
        }

        .desk:active {
            cursor: grabbing;
            transform: scale(1.05);
            z-index: 100;
        }

        .desk span {
            font-weight: bold;
            font-size: 14px;
            word-break: keep-all;
            text-align: center;
        }
        
        .controls {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        /* ì¹ íŒ í‘œì‹œ */
        .blackboard {
            width: 300px;
            height: 30px;
            background-color: #333;
            color: white;
            margin: 0 auto 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 4px;
            font-weight: bold;
        }

    </style>
</head>
<body>

    <div id="screen-1" class="container screen active">
        <h1>ğŸ« í•™ê¸‰ ìë¦¬ ë°°ì¹˜ - ì„¤ì •</h1>
        <div class="input-group">
            <label for="studentCount">í•™ìƒ ìˆ˜ ì…ë ¥: </label>
            <input type="number" id="studentCount" min="1" max="50" value="24">
        </div>
        <button onclick="goToStep2()">ë‹¤ìŒ (ì´ë¦„ ì…ë ¥)</button>
    </div>

    <div id="screen-2" class="container screen">
        <h1>ğŸ“ í•™ìƒ ì´ë¦„ ì…ë ¥</h1>
        <p>ê¸°ë³¸ì ìœ¼ë¡œ ëœë¤ ì´ë¦„ì´ ìƒì„±ë©ë‹ˆë‹¤. í•„ìš”í•˜ë©´ ìˆ˜ì •í•˜ì„¸ìš”.</p>
        <div id="nameInputsContainer" class="name-grid"></div>
        <div class="controls">
            <button class="secondary" onclick="showScreen('screen-1')">ì´ì „</button>
            <button onclick="goToStep3()">ë‹¤ìŒ (ìë¦¬ ë°°ì¹˜)</button>
        </div>
    </div>

    <div id="screen-3" class="container screen" style="max-width: 1400px;">
        <h1>ğŸª‘ ìë¦¬ ë°°ì¹˜ ë° ë°°ì •</h1>
        <div class="blackboard">ì¹  íŒ (ì•)</div>
        
        <div id="classroom-area"></div>

        <div class="controls">
            <button onclick="assignSeats()">ğŸ² ë°°ì •í•˜ê¸°</button>
            <button class="secondary" onclick="resetDeskPositions()">ğŸ”„ ìë¦¬ ë°°ì¹˜ ì´ˆê¸°í™”</button>
            <button class="secondary" onclick="resetAssignments()">ğŸ§¹ ì´ë¦„ ì§€ìš°ê¸°</button>
            <button class="danger" onclick="goHome()">ğŸ  í™ˆìœ¼ë¡œ</button>
        </div>
    </div>

    <script>
        // ëœë¤ ì´ë¦„ ìƒ˜í”Œ ë°ì´í„°
        const lastNames = ['ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ ', 'ê¶Œ', 'í™©', 'ì•ˆ', 'ì†¡', 'ì „', 'í™'];
        const firstNames = ['ë¯¼ì¤€', 'ì„œì¤€', 'ë„ìœ¤', 'ì˜ˆì¤€', 'ì‹œìš°', 'í•˜ì¤€', 'ì§€í˜¸', 'ì§€í›„', 'ì¤€ìš°', 'ì¤€ì„œ', 'ì„œìœ¤', 'ì„œì—°', 'ì§€ìš°', 'í•˜ìœ¤', 'ì§€ìœ ', 'ë¯¼ì„œ', 'ì±„ì›', 'ìˆ˜ì•„', 'ì‹œì•„', 'ë‹¤ì€'];

        let studentCount = 24;
        let studentNames = [];
        let desks = []; // ì±…ìƒ ìš”ì†Œë“¤ì„ ë‹´ì„ ë°°ì—´

        // í™”ë©´ ì „í™˜ í•¨ìˆ˜
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // ëœë¤ ì´ë¦„ ìƒì„±ê¸°
        function generateRandomName() {
            const last = lastNames[Math.floor(Math.random() * lastNames.length)];
            const first = firstNames[Math.floor(Math.random() * firstNames.length)];
            return last + first;
        }

        // STEP 1 -> STEP 2
        function goToStep2() {
            const countInput = document.getElementById('studentCount');
            studentCount = parseInt(countInput.value);

            if (isNaN(studentCount) || studentCount < 1) {
                alert("ì˜¬ë°”ë¥¸ í•™ìƒ ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            const container = document.getElementById('nameInputsContainer');
            container.innerHTML = '';
            
            // ì…ë ¥ì°½ ìƒì„± ë° ëœë¤ ì´ë¦„ ì±„ìš°ê¸°
            for (let i = 0; i < studentCount; i++) {
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'name-input';
                input.value = generateRandomName();
                input.placeholder = `${i+1}ë²ˆ í•™ìƒ`;
                container.appendChild(input);
            }

            showScreen('screen-2');
        }

        // STEP 2 -> STEP 3 (êµì‹¤ ì´ˆê¸°í™”)
        function goToStep3() {
            // ì´ë¦„ ë°ì´í„° ì €ì¥
            const inputs = document.querySelectorAll('.name-input');
            studentNames = Array.from(inputs).map(input => input.value.trim() || "í•™ìƒ");

            // êµì‹¤ ì„¸íŒ… (ìµœì´ˆ 1íšŒ í˜¹ì€ ì§„ì… ì‹œ ë§ˆë‹¤ ë¦¬ì…‹ ì—¬ë¶€ ê²°ì •)
            // ì—¬ê¸°ì„œëŠ” ì§„ì… ì‹œ ì±…ìƒ ë°°ì¹˜ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            initClassroom();
            showScreen('screen-3');
        }

        // êµì‹¤ ë° ì±…ìƒ ìƒì„± í•¨ìˆ˜
        function initClassroom() {
            const classroom = document.getElementById('classroom-area');
            classroom.innerHTML = ''; // ê¸°ì¡´ ì±…ìƒ ì œê±°
            desks = [];

            // ê¸°ë³¸ ë°°ì¹˜: 6ì—´ 4í–‰ (ì´ 24ê°œ ê¸°ì¤€)
            // 4ê°œì”© ëª¨ë‘ : (2x2) í˜•íƒœê°€ ì¼ë°˜ì ì´ì§€ë§Œ, ë“œë˜ê·¸ê°€ ê°€ëŠ¥í•˜ë¯€ë¡œ
            // ì´ˆê¸°ì—ëŠ” ë³´ê¸° ì¢‹ê²Œ ê·¸ë¦¬ë“œ í˜•íƒœë¡œ ë°°ì¹˜í•©ë‹ˆë‹¤.
            
            // ì»¨í…Œì´ë„ˆ í¬ê¸°
            const areaWidth = classroom.clientWidth;
            const areaHeight = classroom.clientHeight;
            
            // ì±…ìƒ í¬ê¸°
            const deskW = 80;
            const deskH = 60;
            const gapX = 20;
            const gapY = 40;
            
            // ëª¨ë‘  ê°„ ê°„ê²© ì¶”ê°€
            const groupGapX = 40; 
            
            // ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì‹œì‘ì  ê³„ì‚° (ëŒ€ëµì ìœ¼ë¡œ)
            const startX = (areaWidth - (6 * deskW + 4 * gapX + 2 * groupGapX)) / 2;
            const startY = 50;

            // ì±…ìƒì€ í•­ìƒ 24ê°œë¥¼ ê¸°ë³¸ìœ¼ë¡œ ìƒì„± (ìš”ì²­ì‚¬í•­ ì¤€ìˆ˜)
            // í•™ìƒ ìˆ˜ê°€ 24ëª…ë³´ë‹¤ ë§ìœ¼ë©´ ì±…ìƒì„ ë” ìƒì„±í•´ì•¼ê² ì§€ë§Œ, 
            // ìš”ì²­ì‚¬í•­ì— "24ê°œì˜ ì±…ìƒì„ ë°°ì¹˜"ë¼ê³  ëª…ì‹œë˜ì–´ ìˆì–´ 24ê°œë¡œ ê³ ì •í•˜ë˜,
            // í•™ìƒì´ ë” ë§ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ studentCountì™€ 24 ì¤‘ í° ê°’ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
            const totalDesks = Math.max(24, studentCount);
            
            let col = 0;
            let row = 0;

            for (let i = 0; i < totalDesks; i++) {
                const desk = document.createElement('div');
                desk.className = 'desk';
                desk.id = `desk-${i}`;
                
                // ë‚´ë¶€ í…ìŠ¤íŠ¸ (ì´ˆê¸°ì—” ë¹ˆìë¦¬)
                const span = document.createElement('span');
                span.innerText = (i < 24) ? `ì±…ìƒ ${i+1}` : `ì˜ˆë¹„ ${i+1}`;
                desk.appendChild(span);

                // ìœ„ì¹˜ ê³„ì‚° (4ì—´ 6í–‰ ëŠë‚Œìœ¼ë¡œ ë°°ì¹˜, ëª¨ë‘  ê³ ë ¤)
                // 2ì—´ì”© ì§ì§€ì–´ ëª¨ë‘ ì„ í˜•ì„±í•œë‹¤ê³  ê°€ì • (2ì—´ x 2í–‰ = 1ëª¨ë‘ )
                // ë‹¨ìˆœíˆ 6ì—´ 4í–‰ ê·¸ë¦¬ë“œë¡œ ë°°ì¹˜í•˜ë˜, 2ì—´ë§ˆë‹¤ ê°„ê²©ì„ ë‘ 
                
                const isRightSideOfGroup = (col % 2 === 1);
                
                let posX = startX + (col * (deskW + gapX));
                if (col >= 2) posX += groupGapX; // 1ë¶„ë‹¨ê³¼ 2ë¶„ë‹¨ ì‚¬ì´
                if (col >= 4) posX += groupGapX; // 2ë¶„ë‹¨ê³¼ 3ë¶„ë‹¨ ì‚¬ì´

                let posY = startY + (row * (deskH + gapY));
                
                // ëª¨ë‘  í˜•íƒœ(ë§ˆì£¼ë³´ê¸°)ë¥¼ ìœ„í•´ ì§ìˆ˜ í–‰ê³¼ í™€ìˆ˜ í–‰ì˜ ê°„ê²©ì„ ì¡°ì ˆí•  ìˆ˜ ìˆìœ¼ë‚˜
                // ë“œë˜ê·¸ê°€ ë˜ë¯€ë¡œ ì‹¬í”Œí•œ ê·¸ë¦¬ë“œë¡œ ì‹œì‘.
                
                desk.style.left = `${posX}px`;
                desk.style.top = `${posY}px`;

                // ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì—°ê²°
                makeDraggable(desk);

                classroom.appendChild(desk);
                desks.push(desk);

                // 6ì—´ ê½‰ ì°¨ë©´ ë‹¤ìŒ ì¤„
                col++;
                if (col >= 6) {
                    col = 0;
                    row++;
                }
            }
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¡œì§
        function makeDraggable(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            elmnt.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // ë§ˆìš°ìŠ¤ ì‹œì‘ ìœ„ì¹˜
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                
                // ë“œë˜ê·¸ ì¤‘ì¸ ìš”ì†Œë¥¼ ë§¨ ì•ìœ¼ë¡œ
                elmnt.style.zIndex = 100;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                // ì´ë™ ê±°ë¦¬ ê³„ì‚°
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;

                // ìƒˆ ìœ„ì¹˜ ì ìš©
                let newTop = elmnt.offsetTop - pos2;
                let newLeft = elmnt.offsetLeft - pos1;

                // ê²½ê³„ ì²´í¬ (í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê²Œ)
                const parent = elmnt.parentElement;
                if (newTop < 0) newTop = 0;
                if (newLeft < 0) newLeft = 0;
                if (newTop + elmnt.offsetHeight > parent.clientHeight) newTop = parent.clientHeight - elmnt.offsetHeight;
                if (newLeft + elmnt.offsetWidth > parent.clientWidth) newLeft = parent.clientWidth - elmnt.offsetWidth;

                elmnt.style.top = newTop + "px";
                elmnt.style.left = newLeft + "px";
            }

            function closeDragElement() {
                // ë“œë˜ê·¸ ì¢…ë£Œ
                document.onmouseup = null;
                document.onmousemove = null;
                elmnt.style.zIndex = 10;
            }
        }

        // ìë¦¬ ë°°ì • ë¡œì§ (ëœë¤ ì…”í”Œ)
        function assignSeats() {
            if (studentNames.length === 0) return;

            // ì´ë¦„ ë°°ì—´ ë³µì‚¬ í›„ ì…”í”Œ (Fisher-Yates Shuffle)
            let shuffledNames = [...studentNames];
            for (let i = shuffledNames.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledNames[i], shuffledNames[j]] = [shuffledNames[j], shuffledNames[i]];
            }

            // ì±…ìƒì— ì´ë¦„ ë„£ê¸°
            desks.forEach((desk, index) => {
                const span = desk.querySelector('span');
                if (index < shuffledNames.length) {
                    span.innerText = shuffledNames[index];
                    desk.style.backgroundColor = "#fff"; // ë°°ì •ë˜ë©´ í°ìƒ‰ ë°°ê²½ ë“±ìœ¼ë¡œ ê°•ì¡°
                    desk.style.border = "2px solid var(--primary-color)";
                } else {
                    span.innerText = "(ë¹ˆìë¦¬)";
                    desk.style.backgroundColor = "#eee";
                    desk.style.border = "2px dashed #999";
                }
            });
        }

        // ì´ë¦„ë§Œ ì´ˆê¸°í™”
        function resetAssignments() {
            desks.forEach((desk, index) => {
                const span = desk.querySelector('span');
                span.innerText = `ì±…ìƒ ${index+1}`;
                desk.style.backgroundColor = "var(--desk-color)";
                desk.style.border = "2px solid var(--desk-border)";
            });
        }

        // ì±…ìƒ ìœ„ì¹˜ ì´ˆê¸°í™”
        function resetDeskPositions() {
            if(confirm("ì±…ìƒ ë°°ì¹˜ë¥¼ ì²˜ìŒ ìƒíƒœë¡œ ë˜ëŒë¦¬ê² ìŠµë‹ˆê¹Œ?")) {
                initClassroom();
            }
        }

        // í™ˆìœ¼ë¡œ (ì „ì²´ ì´ˆê¸°í™”)
        function goHome() {
            if(confirm("ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ? ëª¨ë“  ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.")) {
                studentCount = 24;
                studentNames = [];
                document.getElementById('studentCount').value = 24;
                showScreen('screen-1');
            }
        }

    </script>
</body>
</html>
